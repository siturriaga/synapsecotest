import{b as l}from"./index-CzdKedfN.js";const u={},p="/.netlify/functions/",w="/api/",d="http://localhost:8888",y=(u?.VITE_FUNCTION_BASE_URL||"https://synapsecopilot.com").replace(/\/$/,"");class c extends Error{constructor(e,t){super(e),this.status=t}}async function _(s,e){const t=new Headers(s.headers??{});return typeof s.body=="string"&&!t.has("Content-Type")&&t.set("Content-Type","application/json"),t.set("Accept","application/json"),e&&t.set("Authorization",`Bearer ${e}`),t}async function E(s,e,t){const n=await _(e,t);return fetch(s,{...e,headers:n})}async function F(s){const e=await s.text();try{const t=JSON.parse(e);if(t&&typeof t.error=="string")return t.error}catch{}return e||`Request failed with status ${s.status}`}async function T(s,e={}){const t=await l.currentUser?.getIdToken?.(),n=async o=>{const r=await E(o,e,t);if(r.ok)return r;throw new c(await F(r),r.status)};try{return await(await n(s)).json()}catch(o){if(!(s.startsWith(p)&&o instanceof c&&o.status===404))throw o;const f=`${w}${s.slice(p.length)}`;try{return await(await n(f)).json()}catch(a){if(typeof window<"u"&&typeof window.location<"u"&&window.location.hostname==="localhost"&&a instanceof c&&a.status===404){const i=`${d}${s}`;return await(await n(i)).json()}if(a instanceof c&&a.status===404){const i=`${y}${s}`;return await(await n(i)).json()}throw a}}}export{T as s};
