import{b as d}from"./index-BDE7gFa4.js";const w={},i="/.netlify/functions/",l="/api/",y="http://localhost:8888",E=(w?.VITE_FUNCTION_BASE_URL||"https://synapsecopilot.com").replace(/\/$/,"");class _ extends Error{constructor(n,t){super(n),this.status=t}}async function I(e,n){const t=new Headers(e.headers??{});return typeof e.body=="string"&&!t.has("Content-Type")&&t.set("Content-Type","application/json"),t.set("Accept","application/json"),n&&t.set("Authorization",`Bearer ${n}`),t}async function g(e,n,t){const o=await I(n,t);return fetch(e,{...n,headers:o})}async function F(e){const n=await e.text();try{const t=JSON.parse(n);if(t&&typeof t.error=="string")return t.error}catch{}return n||`Request failed with status ${e.status}`}async function x(e,n={}){const t=await d.currentUser?.getIdToken?.(),o=[],c=r=>{o.includes(r)||o.push(r)};c(e);const f=e.startsWith(i),h=typeof window<"u"&&typeof window.location<"u";f&&(c(`${l}${e.slice(i.length)}`),h&&window.location.hostname==="localhost"&&c(`${y}${e}`),c(`${E}${e}`));let s;for(let r=0;r<o.length;r+=1){const p=o[r];try{const a=await g(p,n,t);if(!a.ok){if(s=new _(await F(a),a.status),r===o.length-1)throw s;continue}const u=a.clone();try{return await a.json()}catch{return await u.text()}}catch(a){if(s=a,r===o.length-1)throw s instanceof Error?s:new Error("Request failed")}}throw s instanceof Error?s:new Error("Request failed")}export{x as s};
