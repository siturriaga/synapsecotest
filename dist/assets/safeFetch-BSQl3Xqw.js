import{b as l}from"./index-Cz65m924.js";const i="/.netlify/functions/",u="/api/",p="http://localhost:8888";class c extends Error{constructor(e,t){super(e),this.status=t}}async function w(s,e){const t=new Headers(s.headers??{});return typeof s.body=="string"&&!t.has("Content-Type")&&t.set("Content-Type","application/json"),t.set("Accept","application/json"),e&&t.set("Authorization",`Bearer ${e}`),t}async function d(s,e,t){const n=await w(e,t);return fetch(s,{...e,headers:n})}async function y(s){const e=await s.text();try{const t=JSON.parse(e);if(t&&typeof t.error=="string")return t.error}catch{}return e||`Request failed with status ${s.status}`}async function L(s,e={}){const t=await l.currentUser?.getIdToken?.(),n=async o=>{const a=await d(o,e,t);if(a.ok)return a;throw new c(await y(a),a.status)};try{return await(await n(s)).json()}catch(o){if(!(s.startsWith(i)&&o instanceof c&&o.status===404))throw o;const f=`${u}${s.slice(i.length)}`;try{return await(await n(f)).json()}catch(r){if(!(typeof window<"u"&&typeof window.location<"u"&&window.location.hostname==="localhost"&&r instanceof c&&r.status===404))throw r;const h=`${p}${s}`;return await(await n(h)).json()}}}export{L as s};
