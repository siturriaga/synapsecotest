import{r as n,j as e}from"./index-Cz65m924.js";import{c as C}from"./catalog-DPHdGcuj.js";import{s as I}from"./safeFetch-BSQl3Xqw.js";import"./firebase-ON2ZZD8i.js";function F({user:x}){const d=n.useMemo(()=>C.subjects,[]),[r,S]=n.useState(""),[i,m]=n.useState(""),[h,u]=n.useState([]),[l,g]=n.useState(null),[j,N]=n.useState("target vocabulary development and conceptual understanding"),[c,T]=n.useState(null),[b,y]=n.useState(!1),[f,p]=n.useState(null),v=n.useMemo(()=>{if(!d.length)return[];if(r){const a=d.find(t=>t.id===r);return Object.keys(a?.grades??{}).sort((t,o)=>Number(t)-Number(o))}const s=new Set;return d.forEach(a=>{Object.keys(a.grades??{}).forEach(t=>s.add(t))}),Array.from(s).sort((a,t)=>Number(a)-Number(t))},[r,d]);n.useEffect(()=>{if(!r||!i){u([]),g(null);return}const s=d.find(t=>t.id===r);if(!s?.grades?.[i]){u([]),g(null),m("");return}const a=s.grades[i]?.standards??[];u(a),g(t=>a.some(o=>o.code===t?.code)?t:null)},[r,i,d]);async function w(){if(!x||!l||!r||!i){p("Sign in and complete the subject, grade, and standard selections first.");return}y(!0),p(null);try{const s=await I("/.netlify/functions/generateAssignment",{method:"POST",body:JSON.stringify({standardCode:l.code,standardName:l.name,focus:j,subject:d.find(a=>a.id===r)?.label??r,grade:i,assessmentType:"reading_plus",questionCount:5,includeRemediation:!0})});T(s)}catch(s){console.error(s),p(s?.message??"Gemini lesson generation failed.")}finally{y(!1)}}return x?e.jsxs("div",{className:"fade-in",style:{display:"grid",gap:24},children:[e.jsxs("section",{className:"glass-card",children:[e.jsx("div",{className:"badge",children:"Standards library"}),e.jsx("h2",{style:{margin:"12px 0 6px",fontSize:28,fontWeight:800},children:"Browse standards by subject and grade"}),e.jsx("p",{style:{color:"var(--text-muted)"},children:"Pick a subject, choose the grade, then select the standard you want to target."}),e.jsxs("div",{style:{display:"grid",gap:16,marginTop:18},children:[e.jsxs("div",{className:"field",children:[e.jsx("label",{htmlFor:"standards-subject",children:"Subject"}),e.jsxs("select",{id:"standards-subject",name:"standards-subject",value:r,onChange:s=>S(s.target.value),children:[e.jsx("option",{value:"",children:"Select a subject"}),d.map(s=>e.jsx("option",{value:s.id,children:s.label},s.id))]})]}),e.jsxs("div",{className:"field",children:[e.jsx("label",{htmlFor:"standards-grade",children:"Grade level"}),e.jsxs("select",{id:"standards-grade",name:"standards-grade",value:i,onChange:s=>m(s.target.value),disabled:!r||v.length===0,children:[e.jsx("option",{value:"",children:r?"Select a grade level":"Select a subject first"}),v.map(s=>e.jsxs("option",{value:s,children:["Grade ",s]},s))]})]})]}),h.length>0?e.jsxs("div",{style:{display:"grid",gap:12,marginTop:18},children:[e.jsxs("div",{className:"field",children:[e.jsx("label",{htmlFor:"standards-code",children:"Standard"}),e.jsxs("select",{id:"standards-code",name:"standards-code",value:l?.code??"",onChange:s=>{const a=h.find(t=>t.code===s.target.value)??null;g(a)},children:[e.jsx("option",{value:"",children:"Select a standard"}),h.map(s=>e.jsxs("option",{value:s.code,children:[s.code," — ",s.name]},s.code))]})]}),l&&e.jsxs("div",{className:"glass-subcard",style:{border:"1px solid rgba(148,163,184,0.25)",borderRadius:18,padding:18,background:"rgba(15,23,42,0.55)"},children:[e.jsx("strong",{children:l.code}),e.jsx("p",{style:{margin:"8px 0 0",color:"var(--text-muted)"},children:l.name})]})]}):e.jsx("div",{className:"empty-state",style:{marginTop:18},children:"Choose a subject and grade to load standards."})]}),e.jsxs("section",{className:"glass-card",style:{display:"grid",gap:18},children:[e.jsx("h3",{style:{margin:0,fontSize:24,fontWeight:700},children:"Differentiated lesson brief"}),e.jsxs("div",{className:"field",children:[e.jsx("label",{htmlFor:"standard-focus",children:"Instructional focus"}),e.jsx("input",{id:"standard-focus",name:"standard-focus",value:j,onChange:s=>N(s.target.value),placeholder:"e.g., connect to career pathways"})]}),e.jsx("button",{className:"primary",onClick:w,disabled:b,children:b?"Generating blueprint…":"Generate AI blueprint"}),f&&e.jsx("div",{style:{color:"#fecaca"},children:f}),c&&e.jsxs("div",{style:{display:"grid",gap:18},children:[e.jsxs("div",{children:[e.jsx("div",{className:"badge",children:"AI overview"}),e.jsxs("h4",{style:{margin:"10px 0 0",fontSize:20},children:[c.standardCode," · ",c.assessmentType.replace(/_/g," ")]}),e.jsx("p",{style:{color:"var(--text-muted)"},children:c.aiInsights.overview})]}),e.jsxs("div",{className:"glass-subcard",style:{border:"1px solid rgba(148,163,184,0.25)",borderRadius:18,padding:18,background:"rgba(15,23,42,0.55)"},children:[e.jsx("strong",{children:"Class strategies"}),e.jsx("ul",{style:{margin:"8px 0 0 18px"},children:c.aiInsights.classStrategies.map((s,a)=>e.jsx("li",{children:s},a))}),e.jsx("strong",{style:{display:"block",marginTop:12},children:"Next steps"}),e.jsx("ul",{style:{margin:"8px 0 0 18px"},children:c.aiInsights.nextSteps.map((s,a)=>e.jsx("li",{children:s},a))})]}),c.levels.map(s=>e.jsxs("article",{style:{border:"1px solid rgba(148,163,184,0.2)",borderRadius:18,padding:18,background:"rgba(15,23,42,0.6)"},children:[e.jsxs("header",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start"},children:[e.jsxs("div",{children:[e.jsx("h5",{style:{margin:0,fontSize:18},children:s.level}),e.jsx("p",{style:{color:"var(--text-muted)",marginTop:4},children:s.description})]}),e.jsx("span",{className:"tag",children:"Differentiated"})]}),e.jsx("div",{style:{marginTop:12,display:"grid",gap:12},children:s.questions.map(a=>e.jsxs("div",{style:{border:"1px solid rgba(99,102,241,0.25)",borderRadius:12,padding:12},children:[e.jsx("strong",{children:"Prompt:"}),e.jsx("p",{style:{margin:"8px 0",color:"var(--text-muted)"},children:a.prompt}),a.options&&e.jsx("ol",{style:{margin:"0 0 0 18px"},children:a.options.map((t,o)=>e.jsx("li",{children:t},o))}),e.jsxs("div",{style:{marginTop:8},children:[e.jsx("strong",{children:"Answer:"})," ",a.answer]}),e.jsxs("div",{style:{marginTop:4,color:"var(--text-muted)"},children:["Why: ",a.rationale]})]},a.id))}),s.remediation.length>0&&e.jsxs("div",{style:{marginTop:12},children:[e.jsx("strong",{children:"Remediation ideas"}),e.jsx("ul",{style:{margin:"8px 0 0 18px"},children:s.remediation.map((a,t)=>e.jsx("li",{children:a},t))})]})]},s.level))]})]})]}):e.jsxs("div",{className:"glass-card fade-in",children:[e.jsx("h2",{style:{margin:0,fontSize:26,fontWeight:800},children:"Authenticate to generate lessons"}),e.jsx("p",{style:{color:"var(--text-muted)"},children:"Your selections are processed securely via Netlify Functions with Gemini."})]})}export{F as default};
